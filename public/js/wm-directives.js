!function(t,e,n){"use strict";wmApp.directive("ngRightClick",["$parse",function(t){return function(e,n,i){var l=t(i.ngRightClick);n.bind("contextmenu",function(t){e.$apply(function(){t.preventDefault(),l(e,{$event:t})})})}}]),wmApp.directive("wmTalent",["$rootScope","talentHelper","$location",function(t,e,n){return{restrict:"E",scope:{classId:"@",col:"@",row:"@",tree:"@",talentPoints:"=",talentPointsDetails:"=",talentTooltips:"=",talentDetails:"="},templateUrl:"/partials/wm-talent.html",link:function(t,i,l){function o(e){var n=t.talentDetails[e],i=!0;return n.requires&&(i=t.talentDetails[n.requires].max_rank==t.talentPoints[n.requires]),5*n.row>t.talentPointsDetails[n.tree].total||0===t.talentPoints[t.talentId]&&0===t.talentPointsDetails.remaining||!i}function s(){return e.getTalentImgPath(t.talentId,t.classId,t.specs[t.classId][t.tree])}function a(){var e=t.talentPoints[t.talentId],n=t.talent.max_rank,i="<h5>"+t.talent.name+"</h5>",l="<h5 class='tooltip-ranks'>Rank "+e+"</h5>",a="",c="",r="",p="",d="<img class='tooltip-image' src='"+s()+"'/>";if(0==e)p="<span class='tooltip-click-to-learn'>Click to learn.</span>",a=t.talentTooltipDescriptions[t.talentPoints[t.talentId]];else if(e<n){if(a=t.talentTooltipDescriptions[t.talentPoints[t.talentId]-1],c=t.talentTooltipDescriptions[t.talentPoints[t.talentId]],!o(t.talentId))r="<div class='tooltip-next-rank'>Next rank:</div>"}else p="<span class='tooltip-click-to-remove'>Right click to remove.</span>",a=t.talentTooltipDescriptions[t.talentPoints[t.talentId]-1];t.tooltip=d+i+l+"<div class='tooltip-description'>"+a+"</div>"+r+"<div class='tooltip-description'>"+c+"</div>"+p}t.specs=specsToString,t.isInactive=o,t.talentImgPath=s,t.addPoint=function(){var i=e.addPoint(1,t.talentId,t.talentPoints,t.talentPointsDetails,t.talentDetails);console.log(t.talentId,t.talentPoints,t.talentPointsDetails),i&&(a(),n.search("talents",e.generateUrl(t.talentPoints)))},t.removePoint=function(){var i=e.removePoint(t.talentId,t.talentPoints,t.talentPointsDetails,t.talentDetails);console.log(t.talentId,t.talentPoints,t.talentPointsDetails),i&&(a(),n.search("talents",e.generateUrl(t.talentPoints)))},t.isInactive=o,function(){for(var e in t.talentDetails)if(t.talentDetails[e].row==t.row&&t.talentDetails[e].col==t.col&&t.talentDetails[e].tree==t.tree)return t.talent=t.talentDetails[e],t.talentId=e,t.talentTooltipDescriptions=t.talentTooltips[e],a(),!0}()}}}]),wmApp.directive("wmTooltip",["$compile","$document","$sce","$window",function(t,e,n,i){return{restrict:"A",scope:{position:"@",content:"@",contentHtml:"=",hideTooltip:"@"},link:function(l,o,s){function a(){var t=o[0].getBoundingClientRect(),e=r[0].getBoundingClientRect(),n=t.width,l=t.height,s=e.width,a=e.height,p=(i.scrollX,i.scrollY);switch(c){case"top-middle":r.css("left",t.left-s/2+n/2+"px"),r.css("top",p+t.top-a-10+"px");break;case"left-middle":r.css("left",t.left-s-10+"px"),r.css("top",p+t.top-a/2+l/2+"px");break;case"right-middle":r.css("left",t.right+10+"px"),r.css("top",p+t.top-a/2+l/2+"px");break;default:r.css("left",t.left-s/2+n/2+"px"),r.css("top",p+t.bottom+10+"px")}r.css("visibility","visible")}l.trustedHtml=function(t){return n.trustAsHtml(t)};var c=l.position||"top-middle",r=t("<div class='wm-tooltip' ng-bind-html='trustedHtml(contentHtml) || content'></div>")(l);e.find("body").append(r),l.hideTooltip||o.bind("mouseenter",function(){a()}),o.bind("mouseleave",function(){r.css("visibility","hidden")}),o.bind("$destroy",function(){l.$destroy()}),l.$on("$destroy",function(){r.remove()})}}}])}(window,document);