!function(t,e,n){"use strict";wmApp.directive("wmGlyph",["talentHelper",function(t){return{restrict:"E",scope:{curGlyphs:"=",index:"="},templateUrl:"/partials/wm-glyph.html",link:function(e,n,l){var i=e.index;e.glyphImgPath=function(){return t.getGlyphImgPath(e.curGlyphs[i])},e.removeGlyph=function(){e.curGlyphs[i]=null,t.changeUrlGlyphs(e.curGlyphs)}}}}]),wmApp.directive("wmModalGlyphs",["$rootScope","$timeout","talentHelper",function(t,e,n){return{restrict:"E",scope:{glyphs:"=",curGlyphs:"=",type:"=",index:"="},templateUrl:"/partials/wm-modal-glyphs.html",link:function(l,i,o){function s(){l.destroying=!0,t.isModalOpen=!1,e(function(){t.showGlyphSelection=!1},300)}var a=l.index;l.modalSearch="",l.removeModal=s,l.getGlyphIconPath=function(t){return"http://wow.zamimg.com/images/wow/icons/medium/"+t.icon.toLowerCase()+".jpg"},l.selectGlyph=function(t){l.curGlyphs[a]=t,n.changeUrlGlyphs(l.curGlyphs),s()},l.alreadyUsed=function(t){return l.curGlyphs.indexOf(t)>-1}}}}]),wmApp.directive("ngMouseWheelUp",function(){return function(e,n,l){n.bind("DOMMouseScroll mousewheel onmousewheel",function(n){var n=t.event||n;Math.max(-1,Math.min(1,n.wheelDelta||-n.detail))>0&&(e.$apply(function(){e.$eval(l.ngMouseWheelUp)}),n.returnValue=!1,n.preventDefault&&n.preventDefault())})}}),wmApp.directive("ngMouseWheelDown",function(){return function(e,n,l){n.bind("DOMMouseScroll mousewheel onmousewheel",function(n){var n=t.event||n;Math.max(-1,Math.min(1,n.wheelDelta||-n.detail))<0&&(e.$apply(function(){e.$eval(l.ngMouseWheelDown)}),n.returnValue=!1,n.preventDefault&&n.preventDefault())})}}),wmApp.directive("ngRightClick",["$parse",function(t){return function(e,n,l){var i=t(l.ngRightClick);n.bind("contextmenu",function(t){e.$apply(function(){t.preventDefault(),i(e,{$event:t})})})}}]),wmApp.directive("wmTalent",["$rootScope","talentHelper",function(t,e){return{restrict:"E",scope:{classId:"@",col:"@",row:"@",tree:"@",talentsSpent:"=",talentsSpentDetails:"=",talentTooltips:"=",talentDetails:"=",tooltipPos:"@"},templateUrl:"/partials/wm-talent.html",link:function(t,n,l){function i(n){return e.isTalentInactive(n,t.talentDetails,t.talentsSpent,t.talentsSpentDetails)}function o(){return e.getTalentImgPath(t.talentId,t.classId,t.specs[t.classId][t.tree])}function s(){t.tooltip=e.getTalentTooltip(t.talentId,t.talent,t.talentsSpent,o(),t.talentTooltipDescriptions,i(t.talentId))}function a(n){n&&(s(),e.changeUrlTalents(t.talentsSpent))}t.specs=specsToString,t.isInactive=i,t.talentImgPath=o,t.addPoint=function(){a(e.addPoint(1,t.talentId,t.talentsSpent,t.talentsSpentDetails,t.talentDetails))},t.removePoint=function(){a(e.removePoint(t.talentId,t.talentsSpent,t.talentsSpentDetails,t.talentDetails))},t.isInactive=i,function(){for(var e in t.talentDetails)if(t.talentDetails[e].row==t.row&&t.talentDetails[e].col==t.col&&t.talentDetails[e].tree==t.tree)return t.talent=t.talentDetails[e],t.talentId=e,t.talentTooltipDescriptions=t.talentTooltips[e],s(),!0}()}}}]),wmApp.directive("wmTooltip",["$compile","$document","$sce","$window",function(t,e,n,l){return{restrict:"A",scope:{position:"@",content:"@",contentHtml:"="},link:function(i,o,s){function a(){var t=o[0].getBoundingClientRect(),e=p[0].getBoundingClientRect(),n=t.width,i=t.height,s=e.width,a=e.height,r=(l.scrollX,l.scrollY);switch("0"==c?c="right-top":"1"==c?c="bottom-middle":"2"==c&&(c="left-top"),c){case"top-middle":p.css("left",t.left-s/2+n/2+"px"),p.css("top",r+t.top-a-20+"px");break;case"left-middle":p.css("left",t.left-s-20+"px"),p.css("top",r+t.top-a/2+i/2+"px");break;case"left-top":p.css("left",t.left-s-20+"px"),p.css("top",r+t.top-a+i/2+"px");break;case"right-middle":p.css("left",t.right+20+"px"),p.css("top",r+t.top-a/2+i/2+"px");break;case"right-top":p.css("left",t.right+20+"px"),p.css("top",r+t.top-a+i/2+"px");break;default:p.css("left",t.left-s/2+n/2+"px"),p.css("top",r+t.bottom+20+"px")}}i.trustedHtml=function(t){return n.trustAsHtml(t)};var c=i.position||"top-middle",p=t("<div class='wm-tooltip' ng-bind-html='trustedHtml(contentHtml) || content'></div>")(i);e.find("body").append(p),o.on("mouseenter",function(){a(),p.css("visibility","visible")}),o.on("mouseleave",function(){p.css("visibility","hidden")}),o.on("$destroy",function(){i.$destroy()}),i.$on("$destroy",function(){p.remove()})}}}])}(window,document);